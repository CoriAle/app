<div ng-controller="CajaModalController as ctrl" class="row">
   <div class="col-sm-7">
      <button ng-click="ctrl.openPagos()" ng-hide="ctrl.activaPago == false" ng-init="ctrl.activaPago==false" class="btn btn-success"><i class="fa fa-credit-card"></i> 
         <strong>Pagos</strong>
      </button>
   </div>
   <div class="col-sm-5">
      <label>Caja:
         <select name="baja" data-placeholder="Seleccione..." ng-options="item.nombre for item in ctrl.lista" ng-change="ctrl.compruebaCaja()" ng-model="ctrl.cajaSelect" class="chosen-select input-md form-control"></select>
      </label>
      <button ng-click="ctrl.accionCaja()" ng-class="!ctrl.estadoCaja ? 'btn-danger':''" ng-show="ctrl.cajaSelect.activo == true" class="btn btn-success"><i class="fa fa-money"></i> 
         <strong ng-if="ctrl.estadoCaja">Aperturar</strong>
         <strong ng-if="!ctrl.estadoCaja">Cerrar</strong>
      </button>
   </div>
</div>
<ul class="nav nav-tabs">
   <li role="presentation"><a ng-href="#/app/caja/pendientes">Cuentas pendientes de pago</a>
   </li>
   <li role="presentation"><a ng-href="#/app/caja/pagadas">Cuentas pagadas</a>
   </li>
</ul>
<div ui-view=""></div>
<style>
   @media print{
       .ioSection{
           display: none;
       }
       .oiSection{
           visibility:visible;
       }
   }
   @media screen{
       .ioSection{
           visibility:visible;
       }
       .oiSection{
           display: none;
       }
   }
</style>
<script type="text/ng-template" id="accionesCaja.html">
   <div class="modal-header"><h3 class="modal-title"><span ng-if="accion.estadoCaja">Aperturar caja: {{accion.caja.nombre}}</span><span ng-if="!accion.estadoCaja">Cerrar caja: {{accion.caja.nombre}}</span></h3><div class="modal-body"></div><div print-section="print-section" class="row"><div class="col-md-12"><span>Cajero: {{accion.cajero.nombre}}</span><br/><span>Fecha Apertura: {{accion.cierre[0].creado | date:'dd/MM/yyyy hh:mm:ss a'}}</span><br/><span class="oiSection">Fecha Cierre: {{accion.cierre[0].modificado | date:'dd/MM/yyyy hh:mm:ss a'}}</span><br/></div><div class="col-md-12"><label class="control-label">Cierre de Caja</label><form name="accion.formAdd" ng-submit="accion.addPago()" novalidate="" class="form-validate form-horizontal"><div class="col-sm-4 ioSection"><div class="form-group"><label class="control-label">Denominación</label><select name="forma" ng-model="accion.denominacion.denominacion" required="" ng-options="den.nombre for den in accion.denominaciones" class="form-control"><option value="">Seleccione una opcion</option></select><div ng-messages="accion.formAdd.forma.$error" ng-show="accion.formAdd.forma.$invalid &amp;&amp; !accion.formAdd.forma.$pristine" class="text-danger"><div ng-message="required">Campo requerido</div></div></div></div><div class="col-sm-8 ioSection"><div class="form-group"><div class="col-sm-4"><label class="control-label">Cantidad</label><input placeholder="Cantidad" type="number" step="1" name="monto" ng-model="accion.denominacion.cantidad" required="" ng-min="0.01" class="form-control"/><div ng-messages="accion.formAdd.monto.$error" ng-show="accion.formAdd.monto.$invalid &amp;&amp; !accion.formAdd.monto.$pristine" class="text-danger"><div ng-message="required">Campo requerido</div><div ng-message="min">Debe ser mayor a 0</div></div></div><div ng-if="accion.denominacion.denominacion.nombre == 'Voucher'" class="col-sm-4"><label class="control-label">Monto</label><input placeholder="Total" type="number" step="1" name="total" ng-model="accion.denominacion.monto" required="" ng-min="0.01" class="form-control"/><div ng-messages="accion.formAdd.total.$error" ng-show="accion.formAdd.total.$invalid &amp;&amp; !accion.formAdd.total.$pristine" class="text-danger"><div ng-message="required">Campo requerido</div><div ng-message="min">Debe ser mayor a 0</div></div></div><div style="margin-top:25px;" class="col-sm-3"><button type="submit" ng-click="accion.addDetalle()" title="Agregar" ng-disabled="accion.formAdd.$invalid" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></div></div></div><div class="form-group col-sm-12"><table class="table table-bordered table-hover primary"><tr style="font-weight: bold"><td style="width:30%">Denominación</td><td style="width:30%">Cantidad</td><td style="width:30%">Subtotal</td><td style="width:10%" class="ioSection">Acciones</td></tr><tr ng-repeat="item in accion.detalle"><td><span ng-if="item.denominacion != 'Voucher'">{{ item.denominacion | currency: 'Q '}}</span><span ng-if="item.denominacion == 'Voucher'">{{ item.denominacion }}</span></td><td>{{ item.cantidad }}</td><td>{{ item.total | currency: 'Q '}}</td><td style="white-space: nowrap" class="ioSection"><div class="buttons"><button type="button" ng-click="accion.remove(item)" class="btn btn-sm btn-danger"><em class="fa fa-trash-o"></em></button></div></td></tr></table></div><div style="font-size:large; font-weight:bold" class="form-group"><p><div ng-if="!accion.estadoCaja" class="col-sm-12"><div class="col-sm-6"><span>Detalle del cierre</span><br/><span>Ventas Efectivo: {{accion.ventas.efectivo | currency : 'Q '}}</span><br/><span>Ventas Tarjeta: {{accion.ventas.tarjeta | currency : 'Q '}}</span><br/><span>Cortesias: {{accion.ventas.cortesias | currency : 'Q '}}</span><br/><span>Total ventas: {{accion.ventas.totales | currency : 'Q '}}</span><br/></div><div style="text-align:right;" class="col-sm-6"><span>Total apertura: {{accion.cierre[0].apertura | currency : 'Q '}}</span><br/><span ng-class="'text-warning'">Total pagos: {{accion.ventas.pagos | currency : 'Q '}}</span><br/><span ng-class="accion.ventas.tdia &lt; 0 ? 'text-danger':'text-success'">Total día: {{accion.ventas.tdia | currency: 'Q '}}</span><br/><span>Cierre: {{accion.total | currency : 'Q '}}</span><br/><span ng-class="accion.ventas.diferencia &lt; 0 ? 'text-danger':'text-success'">Diferencia: {{accion.ventas.diferencia | currency: 'Q '}}</span></div></div><div ng-if="accion.estadoCaja" style="text-align:right;" class="col-sm-12"><span>Total: {{accion.total | currency : 'Q '}}</span></div></p></div></form></div></div></div><div ng-show="accion.errMsg" class="alert alert-danger">{{accion.errMsg}}</div><div ng-show="accion.agregarMsg" class="alert alert-info">{{accion.agregarMsg}}</div><div class="modal-footer"><div class="row"><div style="text-align:left;" class="col-sm-6"><button type="button" ng-click="accion.cancel()" class="btn bg-danger-light"><i class="fa fa-times-circle"></i> Cancelar</button></div><div style="text-align:right;" class="col-sm-6"><button type="button" print-btn="print-btn" ng-disabled="!accion.imprimir" class="btn btn-primary"><i class="fa fa-print"></i> Imprimir</button><button type="button" ng-disabled="accion.valida()" ng-click="accion.submit()" class="btn btn-success"><i class="fa fa-floppy-o"></i> Guardar</button></div></div></div>
</script>
<script type="text/ng-template" id="accionesPago.html">
   <div class="modal-header"><h3 class="modal-title">Ingreso Pago</h3><div class="modal-body">	Detalle de Gasto</div><div class="row"><div class="col-md-12"><form name="accion.formAdd" ng-submit="accion.createFromCaja()" novalidate="" class="form-validate form-horizontal"><div class="form-group"><label class="control-label col-sm-2">Motivo</label><div class="col-sm-9"><select name="motivo" ng-model="accion.motivoSelect" ng-required="true" ng-options="item as item.nombre for item in accion.listaTipoegreso" value="{{accion.listaTipoegreso.id}}" class="input-md form-control"></select></div></div><div class="form-group"><label class="col-sm-2 control-label">Tipo Persona</label><div class="col-sm-4"><select name="tipopersona" ng-model="accion.tipopersonaSelect" ng-required="true" ng-options="item.nombre for item in accion.listaTipopersona" class="input-md form-control"></select></div><label class="control-label col-sm-2">Monto</label><div class="col-sm-2"><input type="number" ng-model="accion.monto" placeholder="Monto" name="monto" ng-required="true" min="0.01" class="form-control"/><div ng-messages="accion.formAdd.monto.$error" ng-show="accion.formAdd.monto.$invalid &amp;&amp; !accion.formAdd.monto.$pristine" class="text-danger"><div ng-message="required">Campo requerido</div><div ng-message="min">No negativos o 0</div></div></div></div><div class="form-group"><label class="control-label col-sm-2">Persona</label><div class="col-sm-4"><div class="input-group"><input name="persona" ng-model="accion.personaSelect" ng-required="true" type="text" placeholder="Buscar por Nombre..." uib-typeahead="cuentas as cuentas.nombre for cuentas in accion.personacuenta($viewValue) | limitTo:7" typeahead-min-length="1" typeahead-loading="loadingTipo" typeahead-no-results="noResultsTipo" ng-show="accion.tipopersonaSelect" value="{{accion.personaSelect.cuenta.id}}" class="form-control"/></div><div ng-show="noResultsTipo" class="text-danger"><i class="fa fa-times">No se encontraron resultados y/o seleccione Tipo Persona</i></div><div ng-messages="accion.formAdd.persona.$error" ng-show="accion.formAdd.persona.$invalid &amp;&amp; !accion.formAdd.persona.$pristine" class="text-danger"><div ng-message="required">Campo requerido</div></div><span auto-close="disabled" ng-show="loadingTipo" class="i fa fa-circle-o-notch fa-spin"></span></div></div><hr/><div class="form-group"><label class="col-sm-2 control-label">Descripcion</label><div class="col-sm-10"><textarea placeholder="Descripcion" name="descripcion" ng-required="true" ng-model="accion.descripcion" class="form-control"></textarea></div></div></form></div></div></div><div ng-show="accion.errMsg" class="alert alert-danger">{{accion.errMsg}}</div><div ng-show="accion.agregarMsg" class="alert alert-info">{{accion.agregarMsg}}</div><div class="modal-footer"><button type="button" ng-click="accion.cancel()" class="btn btn-default"><i class="fa fa-times-circle"></i> Cancelar</button><button type="button" ng-disabled="nuevo.formAdd.$invalid" ng-click="accion.createFromCaja()" ng-class="accion.personaSelect.id &gt; 0 ? 'btn-success':'btn-warning'" class="btn btn-success"><i class="fa fa-floppy-o"></i> Guardar</button></div>
</script>